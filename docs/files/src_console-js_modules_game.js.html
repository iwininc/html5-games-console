<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/console-js/modules/game.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/GettingStarted.html">GettingStarted</a></li>
            
                <li><a href="../classes/iConsole.ads.html">iConsole.ads</a></li>
            
                <li><a href="../classes/iConsole.game.html">iConsole.game</a></li>
            
                <li><a href="../classes/iConsole.iap.html">iConsole.iap</a></li>
            
                <li><a href="../classes/iConsole.mp.html">iConsole.mp</a></li>
            
                <li><a href="../classes/iConsole.mp.simple.html">iConsole.mp.simple</a></li>
            
                <li><a href="../classes/iConsole.periodical.html">iConsole.periodical</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/console-js/modules/game.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Getting Started
 * ---------------
 * Welcome to the documentation for developing games for the iWin Games Console.
 *
 * Quick Start
 * ----------- 
 * To get started quickly please read through the step by step guide here
 * [https://github.com/iwininc/html5-games-console](https://github.com/iwininc/html5-games-console)
 *
 * To see some games already in production using the iWin Games Console please visit
 * - JewelQuest [http://m.iwin.com/game/match3/puzzle-match3-jewelquest]
 * - S&#x27;more Words [http://m.iwin.com/game/puzzle/smorewords]
 * - Yukon Solitaire [http://m.iwin.com/game/casual/solitairequestklondike]
 *
 * Notes on Improving Game Performance
 * -----------------------------------
 * + Only load the required assets at startup and load level specific assets as they are needed.
 * + Think about using JPEGs rather than PNGs (if you can)
 * + Use compressed image file types
 * + Reduce the bit rate for audio files.
 * + When pre-compiling data structures, consider breaking the computation blocks into smaller chunks and use timed callbacks to step through these chunks. This will ensure that the console gains some of the CPU time to ensure it can update the UI accordingly, and ensure that the browser doesn&#x27;t consider the process to have died because it hasn&#x27;t completed the call in a timely manner
 * @class GettingStarted
 * @type {GettingStarted|*{}}
 */

(function (iConsole, Class, Module) {
    function inArray( elem, arr, i ) {
        return arr == null ? -1 : [].indexOf.call( arr, elem, i );
    }
    
    /**
     * Game
     * ---------------
     *
     * As your game loads, you will integrate notification calls to the console to notify it of progress.
     * Typically this is done when pre-loading assets required for the game.
     *
     * Once the game assets have been fully loaded, the game will notify the console that the game has finished loading.
     * The console will do any necessary work, such as dismissing pre-roll advert panels (if configured and after minimum advert duration has been reached).
     *
     * Additional API calls can then be used.
     *
     * @class iConsole.game
     * @type {iConsole.game|*|{}}
     */
	var Game = Class.create(Module, {
        callbacks: [],

		initModule: function ($super, data) {
			$super(data);
		},

		init: function ($super, data) {
			$super(data);
		},

        /**
         * This is the first call you need to make in order for the game and the console to start communicating with
         * each other. This call will return an object that you&#x27;ll need to register a callback handler with, that will
         * be triggered after the pre-game advert has dismissed. You will need to prevent game play taking place until
         * this callback has been triggered, otherwise the game will start playing with an advert sat on top.
         * @param data {Object} An object which declares what functions you support. If you support these functions
         * you should declare them as function:true... i.e. &lt;pre&gt;{ soundOnOff: true }&lt;/pre&gt;. If you do not support these
         * functions, then you do not need to declare them, as they are assumed to be unsupported.
         * Allowable values are:
         * * soundOnOff - Your game will register event handlers for soundOn and soundOff and handle appropriately
         * * pauseable - Your game will register event handlers for pause and resume and handle appropriately
         * * restartable - Your game will register event handlers for restart and handle appropriately
         * @return {Object} An object that contains a member function &lt;code&gt;result&lt;/code&gt; that you should call with a
         * callback function that will be fired when the advert is dismissed. The format of result function is
         * &lt;pre&gt;result( callbackFunction );&lt;/pre&gt;
         * Where callbackFunction is a function that will be called with a single parameter, an object that contains:
         * * a key &lt;code&gt;user&lt;/code&gt; that is an object of the user data
         * * a key &lt;code&gt;console&lt;/code&gt; that is an object containing:
         * ** a key &lt;code&gt;type&lt;/code&gt; that is the type of console that is running, either &lt;code&gt;app&lt;/code&gt; or &lt;code&gt;browser&lt;/code&gt;
         * ** a key &lt;code&gt;provider&lt;/code&gt; that is the provider handling the console
         * @example
         * &lt;pre&gt;
         * iConsole.game.ready({
         *    soundOnOff: true,
         *    pauseable: true,
         *    supportedLanguages:
         * }).result( function( resultData ) {
         *    myGame.setConsoleType(resultData.console.type);
         *    mygame.setConsoleProvider(resultData.console.provider);
         *    myGame.showHomeScreenMenu(resultData.user);
         *    
         * } );
         * &lt;/pre&gt;
         * @method ready
         */
        ready: function (data) {
			return iConsole.XDM.sendReady(data);
		},

        /**
         * While the game is loading all of it&#x27;s assets, you should call this frequently to notify the user (via the
         * pre-game advert progress bar) of the game&#x27;s loading progress. Typically games will pre-load the image /
         * audio assets needed for the menu and first level of the game. Games may also use this time to pre-compile any
         * data blocks that may require a degree of time to complete
         * @param data {Object} an object contains mappings to:
         * &lt;br&gt;&lt;code&gt;progress&lt;/code&gt; a floating point number from 0 to 1 that indicates the progress the game is making
         * in preparing the game for presentation ot the user. At 1 (i.e. 100%) the game should be in a state (once the
         * pre-game advert has been dismissed) where the user can play or view a menu screen with no further loading
         * screens.
         * &lt;br&gt;&lt;code&gt;file&lt;/code&gt; a string containing the file asset you are loading, or it can be a debug message to
         * indicate what you are processing. If debug is enabled in the javascript console, the console will log out the
         * game loading percentage and this file name/message
         * @return The return object is not needed.
         * @example
         * &lt;pre&gt;
         * iConsole.game.loadProgress( {
         *    progress: 0.37,
         *    file: &#x27;music/background_music.mp3&#x27;
         * } );
         * &lt;/pre&gt;
         * @method loadProgress
         */
		loadProgress: function (data) {
			return iConsole.XDM.sendLoadProgress(data);
		},

        /**
         * Once the game has finished loading all of it&#x27;s assets you should call this method to notify the console that
         * you have completed loading of all game assets and pre-compilation. This is in addition to making an
         * &lt;code&gt;iConsole.game.loadProgress( { progress: 1, file: &#x27;&#x27; } );&lt;/code&gt; call. This call to
         * &lt;code&gt;iConsole.game.loaded&lt;/code&gt; indicates to the console that it should allow the user to dismiss the
         * pre-game advert (once the minimum advert time has passed), or if the maximum advert time has passed to
         * immediately dismiss the pre-game advert. This call will ultimately result in the callback function in
         * &lt;code&gt;iConsole.game.ready&lt;/code&gt; to be called.
         * @param data {Object} either:
         * &lt;pre&gt;
         * {
         *    success: true
         * }
         * &lt;/pre&gt;
         * indicating that the game has successfully loaded, or
         * &lt;pre&gt;
         * {
         *    success: false,
         *    item: &#x27;The item that caused the game to fail loading&#x27;,
         *    text: &#x27;Any debug information that may help understand why the game failed to load&#x27;
         * }
         * &lt;/pre&gt;
         * indicating that the game failed to load, where item and text are both strings that are used to identify to
         * the console and developer why the game failed to load.
         * @return {*} The return object is not needed.
         * @example
         * &lt;pre&gt;
         * iConsole.game.loaded( {
         *    success: true
         * } );
         * &lt;/pre&gt;
         * @example
         * &lt;pre&gt;
         * iConsole.game.loaded( {
         *    success: false,
         *    item: &#x27;audio/background_music.mp3&#x27;,
         *    text: &#x27;Error fetching file&#x27;
         * } );
         * &lt;/pre&gt;
         * @method loaded
         */
		loaded: function (data) {
			return iConsole.XDM.sendLoadComplete(data);
		},

        /**
         * This call should be made prior to starting a level, to obtain any data that the game has previously stored
         * for the level about to be played. This is useful to allow a user to continue game progress where they left
         * off. Examples of this can include fetching the data of a previous level (to indicate what items a user has
         * in their in-game inventory). This is an asynchronous call, as the data may need to be fetched from a back-end
         * server, thus the data is passed into a callback function that you must supply to the result function in the
         * returned object.
         * You should also make a call to &lt;code&gt;iConsole.ads.show&lt;/code&gt; with the type set to &lt;code&gt;levelStarted&lt;/code&gt;
         * as well, and wait for both callbacks to complete before continuing on with the game. Suggested order would
         * be to call &lt;code&gt;iConsole.ads.show&lt;/code&gt; first, and then call &lt;code&gt;iConsole.game.getLevelData&lt;/code&gt; to
         * ensure that the user is presented with something that is the game just waiting, and only proceed once both
         * of these functions have triggered their callback functions.
         * @param data {Object}
         * &lt;pre&gt;
         * {
         *    level: &lt;integer&gt;
         * }
         * &lt;/pre&gt;
         * where the level number is any integer from -2147483647 to 2147483647 (-2147483648 is specially reserved)
         * @return {Object} An object that contains a member function &lt;code&gt;result&lt;/code&gt; that you should call with a
         * callback function that will be fired when the user&#x27;s level data is returned. The format of result function is
         * &lt;pre&gt;result( callbackFunction );&lt;/pre&gt;
         * Where callbackFunction is a function that will be called with a single parameter, an object that contains a
         * key &lt;code&gt;data&lt;/code&gt; that is an object of the users data. Any other data other than the &lt;code&gt;data&lt;/code&gt;
         * that may be returned in this object block is deprecated and should not be relied upon.
         * @method getLevelData
         * @example
         * &lt;pre&gt;
         * iConsole.game.getLevelData( { level: 23 } ).result( function ( resultData ) {
         *    myGame.decipherUsersLevelInformation( resultData.data );
         * } );
         * &lt;/pre&gt;
         */
        getLevelData: function (data) {
            return iConsole.XDM.sendGetLevelData(data);
        },

        //todo code review i would suggest making the json being passed inside data valid json
        /**
         * This call should be made to store progress of a level (typically at the end of a level) via a 2k data string.
         * This is useful to allow a user to continue game progress where they left off or to restart previously failed
         * levels. Whilst this may result in a back-end call, this call can be made and no callback function required to
         * handle the result.
         * @param data {Object}
         * &lt;pre&gt;
         * {
         *    level: &lt;integer&gt;
         *    data: &lt;string of up to 2048 characters&gt;
         * }
         * &lt;/pre&gt;
         * where the level number is any integer from -2147483647 to 2147483647 (-2147483648 is specially reserved) and
         * the data is a string of up to 2048 characters to store, where the contents of this are freely under the
         * control of the game developer.
         * @return {*} The return object is not required
         * @method setLevelData
         * @example
         * &lt;pre&gt;
         * iConsole.game.setLevelData( {
         *    level: 24,
         *    data: &quot;{rockets:2,specials:[&#x27;trinity&#x27;,&#x27;primus&#x27;]}&quot;
         * } );
         * &lt;/pre&gt;
         */
        setLevelData: function (data) {
            return iConsole.XDM.sendSetLevelData(data);
        },

        /**
         * This call can be made prior to starting a level or prior to starting a game, to obtain any data that the game
         * has previously stored for the entire game session and any previous information (such as my best score if the
         * game wishes to display that inside its UI). This is useful to allow a user to continue game progress where
         * they left off, for example by storing the current user level. This is an asynchronous call, as the data may
         * need to be fetched from a back-end server, thus the data is passed into a callback function that you must
         * supply to the result function in the returned object.
         * @param data {Object} not used but provided in case of future API changes
         * @return {Object} An object that contains a member function &lt;code&gt;result&lt;/code&gt; that you should call with a
         * callback function that will be fired when the user&#x27;s game data is returned. The format of result function is
         * &lt;pre&gt;result( callbackFunction );&lt;/pre&gt;
         * Where callbackFunction is a function that will be called with a single parameter, an object that contains a
         * key &lt;code&gt;data&lt;/code&gt; that is an object of the users data. Any other data other than the &lt;code&gt;data&lt;/code&gt;
         * that may be returned in this object block is deprecated and should not be relied upon.
         * @method getGameData
         * @example
         * &lt;pre&gt;
         * iConsole.game.getGameData().result( function ( resultData ) {
         *    myGame.decipherUsersGameInformation( resultData.data );
         * } );
         * &lt;/pre&gt;
         */
        getGameData: function (data) {
            return iConsole.XDM.sendGetGameData(data);
        },

        //todo code review i would suggest making the json being passed inside data valid json
        /**
         * This call should be made to store progress in a game session (typically at the end of a level) via a 2k data
         * string. This is useful to allow a user to continue game progress where they left off or to restart previously
         * failed levels. Whilst this may result in a back-end call, this call can be made and no callback function
         * required to handle the result.
         * @param data {Object}
         * &lt;pre&gt;
         * {
         *    data: &lt;string of up to 2048 characters&gt;
         * }
         * &lt;/pre&gt;
         * where the level number is any integer from -2147483647 to 2147483647 (-2147483648 is specially reserved) and
         * the data is a string of up to 2048 characters to store, where the contents of this are freely under the
         * control of the game developer.
         * @return {*} The return object is not required
         * @method setGameData
         * @example
         * &lt;pre&gt;
         * iConsole.game.setGameData( {
         *    data: &quot;{currentLevel:24}&quot;
         * } );
         * &lt;/pre&gt;
         */
        setGameData: function (data) {
            return iConsole.XDM.sendSetGameData(data);
        },

        /**
         * This call should be made whenever the game wishes to post a high score for the global leaderboards for the
         * user. In the future, the console may cause a dialog to appear to congratulate the user on their achievement
         * and so the game should pause execution until the callback function that should be supplied to the
         * &lt;code&gt;result&lt;/code&gt; member function of the returned object has been called. Currently, this will be called
         * immediately.
         * @param data {Object}
         * &lt;pre&gt;
         * {
         *    score: &lt;integer&gt;
         * }
         * &lt;/pre&gt;
         * where the score is an integer of the users high score they achieved.
         * @return {Object} An object that contains a member function &lt;code&gt;result&lt;/code&gt; that you should call with a
         * callback function that will be fired when the high score has been posted and any console interaction
         * resulting from this has completed. The format of result function is &lt;pre&gt;result( callbackFunction );&lt;/pre&gt;
         * Where callbackFunction is a function that will be called with a single parameter, an object that currently
         * contains no data.
         * @method postHighScore
         * @example
         * &lt;pre&gt;
         * iConsole.game.postHighScore( {
         *    score: 945672
         * } ).result( {
         *    myGame.changeState(myGame.RESTART_GAME);
         * } );
         * &lt;/pre&gt;
         */
        postHighScore: function (data) {
            return iConsole.XDM.sendPostHighScore(data);
        },

        /**
         * This function should be called when the user has reached the end of a natural gaming session (i.e. they&#x27;ve
         * run out of lives and can not continue). Game play should not be allowed to continue until the result callback
         * function has been called.
         * @method gameOver
         * @example
         * &lt;pre&gt;
         * iConsole.game.gameOver().result( {
         *    myGame.showMenuScreen();
         * } );
         * &lt;/pre&gt;
         * @return {*}
         */
        gameOver: function () {
            return iConsole.XDM.sendGameOver();
        },

        /**
         * @method levelStarted
         * @deprecated
         * @param info
         * @return {{result: result, trigger: trigger}}
         */
		levelStarted: function (info) {
            var levelData;
            var advertHidden = false;
            var fnCall;
            var context;
            var triggered = false;
            var deferred = {
                result: function(fnToCall, contX) {
                    fnCall = fnToCall;
                    context = contX;
                    this.trigger();
                },
                trigger: function() {
                    if (levelData &amp;&amp; advertHidden &amp;&amp; fnCall &amp;&amp; !triggered) {
                        triggered = true;
                        fnCall.apply(context, [levelData]);
                    }
                }
            };
            iConsole.game.getLevelData(info).result(function(data) {
                levelData = data;
                deferred.trigger();
            });
            iConsole.ads.show({
                type: &#x27;levelStart&#x27;,
                level: info.level
            }).result(function () {
                advertHidden = true;
                deferred.trigger();
            });
			return deferred;
		},

        /**
         * @method levelFinished
         * @deprecated
         * @param info
         * @return {*}
         */
		levelFinished: function (info) {
            // This is bad... the game should be sending the game data, not the console. Only putting this in here to
            // ensure backwards compatibility
            iConsole.game.setGameData(info.data);
			return iConsole.game.setLevelData(info);
		},

        //todo code review the first chunk i think is irrelevant

        /**
         * The user may generate keydown events when they are typing either in the game or in the console. Where the
         * user is typing into their chat window, keydown events are going to be triggered that games will erroneously
         * catch and handle. Therefore, instead of registering keydown handlers inside the game, you should add a
         * handler to the iConsole instead, which will bubble the keydown events except for when the user is typing into
         * fields that shouldn&#x27;t trigger game interaction, such as the chat window.
         * The currently supported event types are:
         * * keydown - When a key is pressed down
         * * signedIn - When a user signs in to the console (used to reload the user data from the console and restart the game)
         * * signedOut - When a user signs out of the console (used to reload the user data and restart the game)
         * * tiltYaxis - When a user tilts their amazon fire phone around the Y axis (used to dismiss menus in game)
         * * soundOff - When the console requests to mute all sounds (the game should store the settings of the user overrides, so that if the sound is already muted, a call to soundOn should revert to the user settings)
         * * soundOn - When the console requests to unmute all sounds (and where a game supports muting of sound effects and music separately, this should return the sound to the previous settings)
         * * pause - When the console requests to pause the game, this should bring up the ingame pause menu (unless the game is not in a pause-able state)
         * * resume - When the console requests to resume paused game play, this should unpause any paused game play (unless the game is not in a paused state)
         * * restart - Only called if the console has received an iConsole.game.gameOver() call, and signifies that the console wants to do the same effect as the user clicking &quot;Replay&quot;. However, if the user has already manually done this, then this should do nothing.
         * * setlocale - If you support locales, you should consider adding support to iConsole.game.onEvent, with the setlocale event. If the user changes their locale during gaming session (the user may wish to change their supported language, this event will fire, and you should cater for updating the UI accordingly.
         * See iConsole.game.offEvent
         * @method onEvent
         * @param eventType {string} currently, the only supported event type is &lt;code&gt;keydown&lt;/code&gt;
         * @param callbackFunction {function} a callback function that will be called every time the console determines
         * a keydown event that should be passed to the game. It will be supplied with a cut down event object, that
         * contains two member variables &lt;code&gt;which&lt;/code&gt; and &lt;code&gt;keyCode&lt;/code&gt; and a function
         * &lt;code&gt;stopPropagation&lt;/code&gt; that can be used to prevent bubbling of the event within the game (if your game
         * registers multiple handlers to the console).
         * @example
         * &lt;pre&gt;
         * iConsole.game.onEvent( &#x27;keydown&#x27;, myGame.keydownHandler );
         * &lt;/pre&gt;
         */
        onEvent: function (eventType, callbackFunction) {
            switch (eventType) {
                case &#x27;signedIn&#x27;:
                    iConsole.on(&#x27;signed.in&#x27;, callbackFunction);
                break;
                case &#x27;signedOut&#x27;:
                    iConsole.on(&#x27;signed.out&#x27;, callbackFunction);
                break;
                default:
                    if (iConsole.game.callbacks[eventType] === undefined) {
                        iConsole.game.callbacks[eventType] = [];
                    }
                    var callbacksForEventType = iConsole.game.callbacks[eventType];
                    if (inArray(callbackFunction, callbacksForEventType) === -1) {
                        callbacksForEventType.push(callbackFunction);
                    }
                break;

            }
        },

        //todo code review the documentation is out of date with the implementation w.r.t. supported types.
        /**
         * The user may generate keydown events when they are typing either in the game or in the console. Where the
         * user is typing into their chat window, keydown events are going to be triggered that games will erroneously
         * catch and handle. Therefore, instead of registering keydown handlers inside the game, you should add a
         * handler to the iConsole instead, which will bubble the keydown events except for when the user is typing into
         * fields that shouldn&#x27;t trigger game interaction, such as the chat window. This call will be used to
         * de-register the keydown handler.
         * See iConsole.game.onEvent
         * @method offEvent
         * @param eventType {string} currently, the only supported event type is &lt;code&gt;keydown&lt;/code&gt;
         * @param callbackFunction {function} the callback function that was previously registered with
         * &lt;code&gt;iConsole.game.onEvent&lt;/code&gt;
         * @example
         * &lt;pre&gt;
         * iConsole.game.offEvent( &#x27;keydown&#x27;, myGame.keydownHandler );
         * &lt;/pre&gt;
         */
        offEvent: function (eventType, callbackFunction) {
            switch (eventType) {
                case &#x27;signedIn&#x27;:
                    iConsole.off(&#x27;signed.in&#x27;, callbackFunction);
                break;
                case &#x27;signedOut&#x27;:
                    iConsole.off(&#x27;signed.out&#x27;, callbackFunction);
                break;
                default:
                    if (iConsole.game.callbacks[eventType] !== undefined) {
                        var callbacksForEventType = iConsole.game.callbacks[eventType];
                        var position = inArray(callbackFunction, callbacksForEventType);
                        if (position !== -1) {
                            callbacksForEventType.splice(position, 1);
                        }
                    }
                break;
            }
        },

        /**
         * This function returns the width of the game inside the console, as window.innerWidth will not work initially
         * when the game is first loaded as the game&#x27;s window is hidden from display. This function is especially
         * useful when trying to determine what resolution of graphics the game should load.
         * @method getWidth
         * @return {*}
         */
        getWidth: function() {
            var frame = window.parent.document.getElementById(&#x27;iconsole-plugin-session_iframe__&#x27;);
            if (frame.parentNode) {
                if (frame.parentNode.parentNode) {
                    return frame.parentNode.parentNode.offsetWidth;
                }
            }
            return 0;
        },

        /**
         * This function returns the height of the game inside the console, as window.innerHeight will not work initially
         * when the game is first loaded as the game&#x27;s window is hidden from display. This function is especially
         * useful when trying to determine what resolution of graphics the game should load.
         * @method getHeight
         * @return {*}
         */
        getHeight: function() {
            var frame = window.parent.document.getElementById(&#x27;iconsole-plugin-session_iframe__&#x27;);
            if (frame.parentNode) {
                if (frame.parentNode.parentNode) {
                    return frame.parentNode.parentNode.offsetHeight;
                }
            }
            return 0;
        },

        /**
         * This function is used to set the label underneath the game&#x27;s image on Amazon Fire devices (currently), and
         * is typically used to relay information such as what level the user is going to resume playback from.
         * @method setHomeWidgetLabel
         * @param label - The label to set, example &#x27;Continue playing from level 5&#x27;  or &#x27;Welcome Back Trooper&#x27;, ...
         * @return {*}
         */
        setHomeWidgetLabel: function(label) {
            return iConsole.XDM.sendUpdateHomeWidgetLabel( { label : label } );
        },

        /**
         * This function is used to explicitly to hide the console window (the chat and highscore window).
         * @method hideConsoleWindow
         * @return {*}
         */
        hideConsoleWindow: function() {
            return iConsole.XDM.sendHideConsoleWindow();
        },

        /**
         * This function is used to make a request to the console to allow it to inform the game which locale the user
         * is expecting to use. The console will make the best guess from the locales you have provided which works best.
         * The locales should be given in LANGUAGE_COUNTRY format, i.e. en-US (case insensitive), and if the users
         * language matches, it will use that locale, falling back to the first language provided that supports the users
         * language (i.e. if the user has fr-CA as their locale, but you only offer fr-FR and fr-MZ, then it will return
         * fr-FR), and where it cannot find a suitable language, attempts to use en-US if provided, and if that fails
         * attempts to use, en, and if that fails it uses the first locale you have provided.
         * If you support locales, you should consider adding support to iConsole.game.onEvent, with the setlocale event.
         * If the user changes their locale during gaming session (the user may wish to change their supported language,
         * this event will fire, and you should cater for updating the UI accordingly.
         * @param locales - an array of string locales that the game supports. If you are offering multiple sets per
         * language, you should attempt to provide the largest populated language first (i.e. fr_FR over fr_CA). Use the
         * following page as an example &lt;a href=&quot;http://www.localeplanet.com/icu/&quot;&gt;http://www.localeplanet.com/icu/&lt;/a&gt;
         * @return {Object} An object that contains a member function &lt;code&gt;result&lt;/code&gt; that you should call with a
         * callback function that will be fired when the console has selected the most appropriate language. There may
         * be user interaction involved, so this is an asynchronous method. The format of result function is
         * * &lt;pre&gt;result( callbackFunction );&lt;/pre&gt; Where callbackFunction is a function that will be called with a
         * * single parameter, an object that will contain a single key, locale which will be a string
         * @method requestLocale
         * @example
         * &lt;pre&gt;
         * iConsole.game.requestLocale( [ ‘en_US’, ’en_GB’, ’es_US’, ’fr_FR’, ’fr_CA’ ] ).result( function( data ){
         *   myApplication.setLocale( data.locale );
         * }
         * &lt;/pre&gt;
         */
        requestLocale: function(locales) {
            return iConsole.XDM.sendRequestLocale( { locales: locales } );
        },
        /**
         * This function is used to indicate the game wishes to exit out of the application entirely. This is
         * effectively a null operation for the desktop console, but on a mobile application, it will either exit the
         * game and return to the game selection menu for the multi game application, or in the case of a single game
         * application, will exit the application entirely. This is typically used in conjunction with the simple
         * multiplayer mode, where the game only supports multiplayer mode, and the user clicks to exit the multiplayer
         * experience.
         * @method exitApplication
         * @example
         * &lt;pre&gt;
         * iConsole.game.exitApplication();
         * &lt;/pre&gt;
         */
        exitApplication: function() {
            return iConsole.XDM.sendExitApplication();
        },

        /*
         * Not for external documentation, but this is called whenever the console fires an event, and this method
         * will look for all handlers that have been registered with the console, and fire an event to each of them,
         * but also stop bubbling events down to further handlers if the game has called stopPropagation.
         */
        eventReceived: function (eventType, event) {
            if (eventType !== undefined &amp;&amp; event !== undefined) {
                event.stopPropagationSet = false;
                event.stopPropagation = function() {this.stopPropagationSet = true;};
                if (iConsole.game.callbacks[eventType] !== undefined) {
                    var callbacksForEventType = iConsole.game.callbacks[eventType];
                    var i = 0;
                    while (i &lt; callbacksForEventType.length &amp;&amp; event.stopPropagationSet === false) {
                        callbacksForEventType[i](event);
                        i++;
                    }
                }
            }
        }
	});

	var m = new Game();

	iConsole.install(&quot;game&quot;, new Game());

	return m;

})(iConsole, Class, Module);
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
